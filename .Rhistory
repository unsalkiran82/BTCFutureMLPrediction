}
i=i+1
}
}
df_data1h<- temp_1hour_cal[,c("BTCOpen","BTCClose","BTCDirection")]
df_data1h_test<- df_data1h[1101:1460,]
df_data1h_test[,"Prediction"]<-bag.probs1h
profit=0.0000
rate=59500
i=0
for(j in 1:360){
if(df_data1h_test$Prediction[j]!= df_data1h_test$Prediction[j+1]){
if(df_data1h_test$Prediction[j]=="Up"){
profit=profit + (df_data1h_test$BTCClose[j]-rate)
rate=df_data1h_test$BTCOpen[j+1]
}
if(df_data1h_test$Prediction[j]=="Down"){
profit=profit + (rate - df_data1h_test$BTCClose[j])
rate=df_data1h_test$BTCOpen[j+1]
}
i=i+1
}
}
df_data1h<- temp_1hour_cal[,c("BTCOpen","BTCClose","BTCDirection")]
df_data1h_test<- df_data1h[1101:1460,]
df_data1h_test[,"Prediction"]<-boost.pred1h
profit=0.0000
rate=59500
i=0
for(j in 1:360){
if(df_data1h_test$Prediction[j]!= df_data1h_test$Prediction[j+1]){
if(df_data1h_test$Prediction[j]=="1"){
profit=profit + (df_data1h_test$BTCClose[j]-rate)
rate=df_data1h_test$BTCOpen[j+1]
}
if(df_data1h_test$Prediction[j]=="0"){
profit=profit + (rate - df_data1h_test$BTCClose[j])
rate=df_data1h_test$BTCOpen[j+1]
}
i=i+1
}
}
df_data1h<- temp_1hour_cal[,c("BTCOpen","BTCClose","BTCDirection")]
df_data1h_test<- df_data1h[1101:1460,]
df_data1h_test[,"Prediction"]<-boost.pred1h
profit=0.0000
rate=59500
i=0
for(j in 1:280){
if(df_data1h_test$Prediction[j]!= df_data1h_test$Prediction[j+1]){
if(df_data1h_test$Prediction[j]=="1"){
profit=profit + (df_data1h_test$BTCClose[j]-rate)
rate=df_data1h_test$BTCOpen[j+1]
}
if(df_data1h_test$Prediction[j]=="0"){
profit=profit + (rate - df_data1h_test$BTCClose[j])
rate=df_data1h_test$BTCOpen[j+1]
}
i=i+1
}
}
df_data1h<- temp_1hour_cal[,c("BTCOpen","BTCClose","BTCDirection")]
df_data1h_test<- df_data1h[1101:1460,]
df_data1h_test[,"Prediction"]<-boost.pred1h
profit=0.0000
rate=59500
i=0
for(j in 1:240){
if(df_data1h_test$Prediction[j]!= df_data1h_test$Prediction[j+1]){
if(df_data1h_test$Prediction[j]=="1"){
profit=profit + (df_data1h_test$BTCClose[j]-rate)
rate=df_data1h_test$BTCOpen[j+1]
}
if(df_data1h_test$Prediction[j]=="0"){
profit=profit + (rate - df_data1h_test$BTCClose[j])
rate=df_data1h_test$BTCOpen[j+1]
}
i=i+1
}
}
df_data1h<- temp_1hour_cal[,c("BTCOpen","BTCClose","BTCDirection")]
df_data1h_test<- df_data1h[1101:1460,]
df_data1h_test[,"Prediction"]<-boost.pred1h
profit=0.0000
rate=59500
i=0
for(j in 1:250){
if(df_data1h_test$Prediction[j]!= df_data1h_test$Prediction[j+1]){
if(df_data1h_test$Prediction[j]=="1"){
profit=profit + (df_data1h_test$BTCClose[j]-rate)
rate=df_data1h_test$BTCOpen[j+1]
}
if(df_data1h_test$Prediction[j]=="0"){
profit=profit + (rate - df_data1h_test$BTCClose[j])
rate=df_data1h_test$BTCOpen[j+1]
}
i=i+1
}
}
df_data1h<- temp_1hour_cal[,c("BTCOpen","BTCClose","BTCDirection")]
df_data1h_test<- df_data1h[1101:1460,]
df_data1h_test[,"Prediction"]<-boost.pred1h
profit=0.0000
rate=59500
i=0
for(j in 1:280){
if(df_data1h_test$Prediction[j]!= df_data1h_test$Prediction[j+1]){
if(df_data1h_test$Prediction[j]=="1"){
profit=profit + (df_data1h_test$BTCClose[j]-rate)
rate=df_data1h_test$BTCOpen[j+1]
}
if(df_data1h_test$Prediction[j]=="0"){
profit=profit + (rate - df_data1h_test$BTCClose[j])
rate=df_data1h_test$BTCOpen[j+1]
}
i=i+1
}
}
df_data1h<- temp_1hour_cal[,c("BTCOpen","BTCClose","BTCDirection")]
df_data1h_test<- df_data1h[1101:1460,]
df_data1h_test[,"Prediction"]<-boost.pred1h
profit=0.0000
rate=59500
i=0
for(j in 1:290){
if(df_data1h_test$Prediction[j]!= df_data1h_test$Prediction[j+1]){
if(df_data1h_test$Prediction[j]=="1"){
profit=profit + (df_data1h_test$BTCClose[j]-rate)
rate=df_data1h_test$BTCOpen[j+1]
}
if(df_data1h_test$Prediction[j]=="0"){
profit=profit + (rate - df_data1h_test$BTCClose[j])
rate=df_data1h_test$BTCOpen[j+1]
}
i=i+1
}
}
df_data1h<- temp_1hour_cal[,c("BTCOpen","BTCClose","BTCDirection")]
df_data1h_test<- df_data1h[1101:1460,]
df_data1h_test[,"Prediction"]<-boost.pred1h
profit=0.0000
rate=59500
i=0
for(j in 1:275){
if(df_data1h_test$Prediction[j]!= df_data1h_test$Prediction[j+1]){
if(df_data1h_test$Prediction[j]=="1"){
profit=profit + (df_data1h_test$BTCClose[j]-rate)
rate=df_data1h_test$BTCOpen[j+1]
}
if(df_data1h_test$Prediction[j]=="0"){
profit=profit + (rate - df_data1h_test$BTCClose[j])
rate=df_data1h_test$BTCOpen[j+1]
}
i=i+1
}
}
df_data1h<- temp_1hour_cal[,c("BTCOpen","BTCClose","BTCDirection")]
df_data1h_test<- df_data1h[1101:1460,]
df_data1h_test[,"Prediction"]<-boost.pred1h
profit=0.0000
rate=59500
i=0
for(j in 1:270){
if(df_data1h_test$Prediction[j]!= df_data1h_test$Prediction[j+1]){
if(df_data1h_test$Prediction[j]=="1"){
profit=profit + (df_data1h_test$BTCClose[j]-rate)
rate=df_data1h_test$BTCOpen[j+1]
}
if(df_data1h_test$Prediction[j]=="0"){
profit=profit + (rate - df_data1h_test$BTCClose[j])
rate=df_data1h_test$BTCOpen[j+1]
}
i=i+1
}
}
df_data1h<- temp_1hour_cal[,c("BTCOpen","BTCClose","BTCDirection")]
df_data1h_test<- df_data1h[1101:1460,]
df_data1h_test[,"Prediction"]<-boost.pred1h
profit=0.0000
rate=59500
i=0
for(j in 1:275){
if(df_data1h_test$Prediction[j]!= df_data1h_test$Prediction[j+1]){
if(df_data1h_test$Prediction[j]=="1"){
profit=profit + (df_data1h_test$BTCClose[j]-rate)
rate=df_data1h_test$BTCOpen[j+1]
}
if(df_data1h_test$Prediction[j]=="0"){
profit=profit + (rate - df_data1h_test$BTCClose[j])
rate=df_data1h_test$BTCOpen[j+1]
}
i=i+1
}
}
df_data1h<- temp_1hour_cal[,c("BTCOpen","BTCClose","BTCDirection")]
df_data1h_test<- df_data1h[1101:1460,]
df_data1h_test[,"Prediction"]<-boost.pred1h
profit=0.0000
rate=59500
i=0
for(j in 1:272){
if(df_data1h_test$Prediction[j]!= df_data1h_test$Prediction[j+1]){
if(df_data1h_test$Prediction[j]=="1"){
profit=profit + (df_data1h_test$BTCClose[j]-rate)
rate=df_data1h_test$BTCOpen[j+1]
}
if(df_data1h_test$Prediction[j]=="0"){
profit=profit + (rate - df_data1h_test$BTCClose[j])
rate=df_data1h_test$BTCOpen[j+1]
}
i=i+1
}
}
df_data1h<- temp_1hour_cal[,c("BTCOpen","BTCClose","BTCDirection")]
df_data1h_test<- df_data1h[1101:1460,]
df_data1h_test[,"Prediction"]<-boost.pred1h
profit=0.0000
rate=59500
i=0
for(j in 1:272){
if(df_data1h_test$Prediction[j]!= df_data1h_test$Prediction[j+1]){
if(df_data1h_test$Prediction[j]=="1"){
profit=profit + (df_data1h_test$BTCClose[j]-rate)
rate=df_data1h_test$BTCOpen[j+1]
}
if(df_data1h_test$Prediction[j]=="0"){
profit=profit + (rate - df_data1h_test$BTCClose[j])
rate=df_data1h_test$BTCOpen[j+1]
}
i=i+1
}
}
df_data1h<- temp_1hour_cal[,c("BTCOpen","BTCClose","BTCDirection")]
df_data1h_test<- df_data1h[1101:1460,]
df_data1h_test[,"Prediction"]<-boost.pred1h
profit=0.0000
rate=59500
i=0
for(j in 1:273){
if(df_data1h_test$Prediction[j]!= df_data1h_test$Prediction[j+1]){
if(df_data1h_test$Prediction[j]=="1"){
profit=profit + (df_data1h_test$BTCClose[j]-rate)
rate=df_data1h_test$BTCOpen[j+1]
}
if(df_data1h_test$Prediction[j]=="0"){
profit=profit + (rate - df_data1h_test$BTCClose[j])
rate=df_data1h_test$BTCOpen[j+1]
}
i=i+1
}
}
df_data1h<- temp_1hour_cal[,c("BTCOpen","BTCClose","BTCDirection")]
df_data1h_test<- df_data1h[1101:1460,]
df_data1h_test[,"Prediction"]<-boost.pred1h
profit=0.0000
rate=59500
i=0
for(j in 1:274){
if(df_data1h_test$Prediction[j]!= df_data1h_test$Prediction[j+1]){
if(df_data1h_test$Prediction[j]=="1"){
profit=profit + (df_data1h_test$BTCClose[j]-rate)
rate=df_data1h_test$BTCOpen[j+1]
}
if(df_data1h_test$Prediction[j]=="0"){
profit=profit + (rate - df_data1h_test$BTCClose[j])
rate=df_data1h_test$BTCOpen[j+1]
}
i=i+1
}
}
df_data1m<- temp_1min_cal[,c("BTCOpen","BTCClose","BTCDirection")]
df_data1m_test<- df_data1m[65001:86636,]
df_data1m_test[,"Prediction"]<-bag.probs1m
profit=0.0000
rate=59365
i=0
for(j in 1:14980){
if(df_data1m_test$Prediction[j]!= df_data1m_test$Prediction[j+1]){
if(df_data1m_test$Prediction[j]=="Up"){
profit=profit + (df_data1m_test$BTCClose[j]-rate)
rate=df_data1m_test$BTCOpen[j+1]
}
if(df_data1m_test$Prediction[j]=="Down"){
profit=profit + (rate - df_data1m_test$BTCClose[j])
rate=df_data1m_test$BTCOpen[j+1]
}
i=i+1
}
}
df_data5m<- temp_5min_cal[,c("BTCOpen","BTCClose","BTCDirection")]
df_data5m_test<- df_data5m[13001:17328,]
df_data5m_test[,"Prediction"]<-boost.pred5m
profit=0.0000
rate=59430
i=0
for(j in 1:2878){
if(df_data5m_test$Prediction[j]!= df_data5m_test$Prediction[j+1]){
if(df_data5m_test$Prediction[j]=="1"){
profit=profit + (df_data5m_test$BTCClose[j]-rate)
rate=df_data5m_test$BTCOpen[j+1]
}
if(df_data5m_test$Prediction[j]=="0"){
profit=profit + (rate - df_data5m_test$BTCClose[j])
rate=df_data5m_test$BTCOpen[j+1]
}
i=i+1
}
}
df_data1m<- temp_1min_cal[,c("BTCOpen","BTCClose","BTCDirection")]
df_data1m_test<- df_data1m[65001:86636,]
df_data1m_test[,"Prediction"]<-tree.pred1m
profit=0.0000
rate=59365
i=0
for(j in 1:14980){
if(df_data1m_test$Prediction[j]!= df_data1m_test$Prediction[j+1]){
if(df_data1m_test$Prediction[j]=="Up"){
profit=profit + (df_data1m_test$BTCClose[j]-rate)
rate=df_data1m_test$BTCOpen[j+1]
}
if(df_data1m_test$Prediction[j]=="Down"){
profit=profit + (rate - df_data1m_test$BTCClose[j])
rate=df_data1m_test$BTCOpen[j+1]
}
i=i+1
}
}
df_data1m<- temp_1min_cal[,c("BTCOpen","BTCClose","BTCDirection")]
df_data1m_test<- df_data1m[65001:86636,]
df_data1m_test[,"Prediction"]<-boost.pred1m
profit=0.0000
rate=59365
i=0
for(j in 1:14980){
if(df_data1m_test$Prediction[j]!= df_data1m_test$Prediction[j+1]){
if(df_data1m_test$Prediction[j]=="1"){
profit=profit + (df_data1m_test$BTCClose[j]-rate)
rate=df_data1m_test$BTCOpen[j+1]
}
if(df_data1m_test$Prediction[j]=="0"){
profit=profit + (rate - df_data1m_test$BTCClose[j])
rate=df_data1m_test$BTCOpen[j+1]
}
i=i+1
}
}
df_data5m<- temp_5min_cal[,c("BTCOpen","BTCClose","BTCDirection")]
df_data5m_test<- df_data5m[13001:17328,]
df_data5m_test[,"Prediction"]<-bag.probs5m
profit=0.0000
rate=59430
i=0
for(j in 1:2878){
if(df_data5m_test$Prediction[j]!= df_data5m_test$Prediction[j+1]){
if(df_data5m_test$Prediction[j]=="Up"){
profit=profit + (df_data5m_test$BTCClose[j]-rate)
rate=df_data5m_test$BTCOpen[j+1]
}
if(df_data5m_test$Prediction[j]=="Down"){
profit=profit + (rate - df_data5m_test$BTCClose[j])
rate=df_data5m_test$BTCOpen[j+1]
}
i=i+1
}
}
df_data1h<- temp_1hour_cal[,c("BTCOpen","BTCClose","BTCDirection")]
df_data1h_test<- df_data1h[1101:1460,]
df_data1h_test[,"Prediction"]<-bag.probs1h
profit=0.0000
rate=59500
i=0
for(j in 1:274){
if(df_data1h_test$Prediction[j]!= df_data1h_test$Prediction[j+1]){
if(df_data1h_test$Prediction[j]=="1"){
profit=profit + (df_data1h_test$BTCClose[j]-rate)
rate=df_data1h_test$BTCOpen[j+1]
}
if(df_data1h_test$Prediction[j]=="0"){
profit=profit + (rate - df_data1h_test$BTCClose[j])
rate=df_data1h_test$BTCOpen[j+1]
}
i=i+1
}
}
df_data1h<- temp_1hour_cal[,c("BTCOpen","BTCClose","BTCDirection")]
df_data1h_test<- df_data1h[1101:1460,]
df_data1h_test[,"Prediction"]<-bag.probs1h
profit=0.0000
rate=59500
i=0
for(j in 1:274){
if(df_data1h_test$Prediction[j]!= df_data1h_test$Prediction[j+1]){
if(df_data1h_test$Prediction[j]=="Up"){
profit=profit + (df_data1h_test$BTCClose[j]-rate)
rate=df_data1h_test$BTCOpen[j+1]
}
if(df_data1h_test$Prediction[j]=="Down"){
profit=profit + (rate - df_data1h_test$BTCClose[j])
rate=df_data1h_test$BTCOpen[j+1]
}
i=i+1
}
}
library(plotly)
library(quantmod)
View(temp_1hour_cal)
df<- temp_1hour_cal
plot(temp_1hour_cal$Timestamp, temp_1hour_cal$BTCClose,
main="Bitcoin Price",
ylab="Price",
type="l",
col="blue")
plot( temp_1hour_cal$BTCClose,
main="Bitcoin Price",
ylab="Price",
type="l",
col="blue")
View(temp_1hour_cal)
plot( as.Date(temp_1hour_cal$Timestamp), temp_1hour_cal$BTCClose,
main="Bitcoin Price",
ylab="Price",
type="l",
col="blue")
plot( as.POSIXct.Date(temp_1hour_cal$Timestamp), temp_1hour_cal$BTCClose,
main="Bitcoin Price",
ylab="Price",
type="l",
col="blue")
plot( c("21/01/2021","30/02/2021"), temp_1hour_cal$BTCClose,
main="Bitcoin Price",
ylab="Price",
type="l",
col="blue")
plot( 30/02/2021", temp_1hour_cal$BTCClose,
main="Bitcoin Price",
ylab="Price",
type="l",
col="blue")
plot( 30/02/2021, temp_1hour_cal$BTCClose,
main="Bitcoin Price",
ylab="Price",
type="l",
col="blue")
plot( date(), temp_1hour_cal$BTCClose,
main="Bitcoin Price",
ylab="Price",
type="l",
col="blue")
?date
library(MASS)
attach(temp_1hour_cal)
qdareg_train_1h=temp_1hour_cal[1:1100,a]
qdareg_test_1h=temp_1hour_cal[1101:1460,a]
testdir_qda_1h=qdareg_test_1h$BTCDirection
qda.fits1h=qda(BTCDirection~.,data = qdareg_train_1h)
qda.pred1h=predict(qda.fits1h,qdareg_test_1h)
qda.class1h=qda.pred1h$class
table(testdir_qda_1h,qda.class1h)
library(MASS)
attach(temp_1hour_cal)
b<- c("BTCVolLag1","BTCVolLag2","BTCVolLag3","BTCRtnLag1","BTCRtnLag2","BTCRtnLag3",
"EURRtnLag1","EURRtnLag2","EURRtnLag3","SPCRtnLag1","SPCRtnLag2","SPCRtnLag3",
"NASCRtnLag1","NASCRtnLag2","NASCRtnLag3","SPCVRtnLag1","SPCVRtnLag2","SPCVRtnLag3",
"NASCVRtnLag1","NASCVRtnLag2","NASCVRtnLag3","BTCDirection")
ldareg_train_1h=temp_1hour_cal[1:1100,b]
ldareg_test_1h=temp_1hour_cal[1101:1460,b]
testdir_lda_1h=ldareg_test_1h$BTCDirection
lda.fits1h=lda(BTCDirection~.,data = ldareg_train_1h)
lda.pred1h=predict(lda.fits1h,ldareg_test_1h)
lda.class1h=lda.pred1h$class
table(testdir_lda_1h,lda.class1h)
library(MASS)
attach(temp_1hour_cal)
b<- c("BTCVolLag1","BTCVolLag2","BTCVolLag3","BTCRtnLag1","BTCRtnLag2","BTCRtnLag3",
"EURRtnLag1","EURRtnLag2","EURRtnLag3","SPCRtnLag1","SPCRtnLag2","SPCRtnLag3",
"NASCRtnLag1","NASCRtnLag2","NASCRtnLag3","SPCVRtnLag1","SPCVRtnLag2","SPCVRtnLag3",
"NASCVRtnLag1","NASCVRtnLag2","BTCDirection")
//"NASCVRtnLag3"
ldareg_train_1h=temp_1hour_cal[1:1100,b]
ldareg_test_1h=temp_1hour_cal[1101:1460,b]
testdir_lda_1h=ldareg_test_1h$BTCDirection
lda.fits1h=lda(BTCDirection~.,data = ldareg_train_1h)
lda.pred1h=predict(lda.fits1h,ldareg_test_1h)
lda.class1h=lda.pred1h$class
table(testdir_lda_1h,lda.class1h)
library(MASS)
attach(temp_1hour_cal)
b<- c("BTCVolLag1","BTCVolLag2","BTCVolLag3","BTCRtnLag1","BTCRtnLag2","BTCRtnLag3",
"EURRtnLag1","EURRtnLag2","EURRtnLag3","SPCRtnLag1","SPCRtnLag2","SPCRtnLag3",
"NASCRtnLag1","NASCRtnLag2","NASCRtnLag3","SPCVRtnLag1","SPCVRtnLag2","SPCVRtnLag3",
"BTCDirection")
//"NASCVRtnLag3" "NASCVRtnLag1","NASCVRtnLag2"
ldareg_train_1h=temp_1hour_cal[1:1100,b]
ldareg_test_1h=temp_1hour_cal[1101:1460,b]
testdir_lda_1h=ldareg_test_1h$BTCDirection
lda.fits1h=lda(BTCDirection~.,data = ldareg_train_1h)
lda.pred1h=predict(lda.fits1h,ldareg_test_1h)
lda.class1h=lda.pred1h$class
table(testdir_lda_1h,lda.class1h)
library(MASS)
attach(temp_1hour_cal)
b<- c("BTCVolLag1","BTCVolLag2","BTCVolLag3","BTCRtnLag1","BTCRtnLag2","BTCRtnLag3",
"EURRtnLag1","EURRtnLag2","EURRtnLag3","SPCRtnLag1","SPCRtnLag2","SPCRtnLag3",
"NASCRtnLag1","NASCRtnLag2","NASCRtnLag3","SPCVRtnLag1","SPCVRtnLag2","SPCVRtnLag3",
"NASCVRtnLag1","NASCVRtnLag2","NASCVRtnLag3","BTCDirection")
ldareg_train_1h=temp_1hour_cal[1:1100,b]
ldareg_test_1h=temp_1hour_cal[1101:1460,b]
testdir_lda_1h=ldareg_test_1h$BTCDirection
lda.fits1h=lda(BTCDirection~.,data = ldareg_train_1h)
lda.pred1h=predict(lda.fits1h,ldareg_test_1h)
lda.class1h=lda.pred1h$class
table(testdir_lda_1h,lda.class1h)
